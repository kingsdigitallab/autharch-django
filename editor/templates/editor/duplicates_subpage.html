{% extends "./base.html" %}
{% block main %}
<main id="duplicates-subpage">
    {% block page_header %}
        <a href="{{ edit_url }}"><i class="fas fa-chevron-left margin-right"></i><span class="dotted-underline">Back to {{ entity|truncatewords:15 }}</span></a>

        <div class="page-header">
            <h1>Duplicates: {{entity}} (2)</h1>
        </div>
    {% endblock page_header %}
    {% block content %}
        <!--         
        <div class="success-notification">
            if merge
            <h4>The record [record_id] was merged into the record [record_id].</h4>
            if unrelated
            <h4>The record [record_id] was marked as "not a duplicate" of the record [record_id].</h4>
        </div> 
        -->
        <div class="current-record">
            <p class="highlight">Browsed record:</p>
            <a href="{{ edit_url }}" target="_blank" class="dotted-underline">{{entity}}</a>
            <div class="subitems">
                <ul>
                    <li>Record ID: {{entity.id}}</li>
                    <li>Type: {{entity.entity_type}}</li>
                    <li>Publication status: {{publication_status}}</li>
                    <li>Updated: {{ last_revision.date_created }} by {{ last_revision.user }}</li>
                </ul>
            </div>
        </div>  
        <div id="add-record-form" class="active">
            <select name="add_record" class="select-with-search" aria-label="Add a record by record id or display name"></select>
            <button class="create">Add to the list</button>
        </div> 
        <form action="." id="duplicates-form">
            <div class="duplicates-list">
                <p class="highlight">Merge duplicates into browsed record:</p>
                <div class="duplicate">
                    <div class="cta">
                        <input type="checkbox" name="duplicate" id="duplicate_[entity_id1]" value="[entity_id1]" onclick="showModal('merge-modal')">
                        <label for="duplicate_[entity_id1]">Merge</label>
                        <input type="checkbox" name="not_duplicate"  id="not_duplicate_[entity_id1]" value="[entity_id1]" onclick="showModal('notRelated-modal')">
                        <label for="not_duplicate_[entity_id1]">Not a duplicate</label>
                    </div>
                    <div class="record">
                       <a href="" target="_blank" class="dotted-underline">[entity_display_name]</a><span class="divider"></span><a href=""><i class="fal fa-copy"></i> <span class="dotted-underline">See the duplicates page of this record</span></a>
                       <div class="subitems">
                           <ul>
                                <li>Record ID: [entity_id1]</li>
                                <li>Type: [entity_type]</li>
                                <li>Publication status: [publication_status]</li>
                                <li>Updated: [ entity_updated ] by [ username ]</li>
                            </ul>
                        </div> 
                    </div>
                </div>
                <div class="duplicate">
                    <div class="cta">
                        <input type="checkbox" name="duplicate" id="duplicate_[entity_id2]" value="[entity_id2]" onclick="showModal('merge-modal')">
                        <label for="duplicate_[entity_id2]">Merge</label>
                        <input type="checkbox" name="not_duplicate"  id="not_duplicate_[entity_id2]" value="[entity_id2]" onclick="showModal('notRelated-modal')">
                        <label for="not_duplicate_[entity_id2]">Not a duplicate</label>
                    </div>
                    <div class="record">
                        <a href="" target="_blank" class="dotted-underline">[entity_display_name]</a><span class="divider"></span><a href=""><i class="fal fa-copy"></i> <span class="dotted-underline">See the duplicates page of this record</span></a>
                        <div class="subitems">
                            <ul>
                                <li>Record ID: [entity_id2]</li>
                                <li>Type: [entity_type]</li>
                                <li>Publication status: [publication_status]</li>
                                <li>Updated: [ entity_updated ] by [ username ]</li>
                            </ul>
                        </div> 
                     </div>
                </div>
            </div>
            <!-- if manually_removed > 0 -->
            <label for="show-removed-checkbox" class="dotted-underline">Show/hide records marked as "not a duplicate":</label>
            <input type="checkbox" id="show-removed-checkbox"/>
            <div class="manually-removed">
                <div class="duplicate">
                    <div class="cta">
                        <input type="checkbox" name="duplicate" id="duplicate_[entity_id3]" value="[entity_id3]" onclick="showModal('merge-modal')">
                        <label for="duplicate_[entity_id3]">Merge</label>
                        <input type="checkbox" name="not_duplicate"  id="not_duplicate_[entity_id3]" value="[entity_id3]" checked disabled>
                        <label for="not_duplicate_[entity_id3]">Not a duplicate</label>
                    </div>
                    <div class="record">
                        <a href="" target="_blank" class="dotted-underline">[entity_display_name]</a><span class="divider"></span><a href=""><i class="fal fa-copy"></i> <span class="dotted-underline">See the duplicates page of this record</span></a>
                        <div class="subitems">
                            <ul>
                                <li>Record ID: [entity_id3]</li>
                                <li>Type: [entity_type]</li>
                                <li>Publication status: [publication_status]</li>
                                <li>Updated: [ entity_updated ] by [ username ]</li>
                            </ul>
                        </div> 
                     </div>
                </div>
            </div>
        </form>
        <!-- if duplicates.length == 0 -->
        <!-- <div class="empty-block">
            <p>You don't have duplicates for this record. &#127881;</p>
        </div> -->
        <div class="modal" id="merge-modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Confirm merge</h2>
              </div>
              <div class="modal-body">
                <div class="data-from"></div>
                <span class="action">merge into: </span>
                <div class="data-to">
                    <a href="{{ edit_url }}" target="_blank" class="dotted-underline">{{entity}}</a>, Record ID: {{entity.id}}
                </div>
              </div>
              <div class="modal-footer">
                <form action="." method="post">
                  {% csrf_token %}
                  <input type="button" value="Cancel" class="default modal-cancel"/>
                  <input type="submit" value="Confirm merge" class="create" form="duplicates-form"/>
                </form>
              </div>
            </div>
          </div>
          <div class="modal" id="notRelated-modal">
            <div class="modal-content">
              <div class="modal-header">
                <h2>Confirm this record is not a duplicate</h2>
              </div>
              <div class="modal-body">
                <div class="data-from"></div>
                <span class="action">not a duplicate of: </span>
                <div class="data-to">
                    <a href="{{ edit_url }}" target="_blank" class="dotted-underline">{{entity}}</a>, Record ID: {{entity.id}}
                </div>
              </div>
              <div class="modal-footer">
                <form action="." method="post">
                  {% csrf_token %}
                  <input type="button" value="Cancel" class="default modal-cancel"/>
                  <input type="submit" value="Confirm not a duplicate" class="create" form="duplicates-form"/>
                </form>
              </div>
            </div>
          </div>
    {% endblock content %}
</main>
{% endblock main %}